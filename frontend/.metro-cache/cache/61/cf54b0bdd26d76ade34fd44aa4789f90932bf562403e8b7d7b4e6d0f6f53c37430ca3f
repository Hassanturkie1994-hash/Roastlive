{"dependencies":[{"name":"../lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":43,"index":43}}],"key":"phU7YuntQKgoAYKWKHVlsIL7LCY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"postsService\", {\n    enumerable: true,\n    get: function () {\n      return postsService;\n    }\n  });\n  var _libSupabase = require(_dependencyMap[0], \"../lib/supabase\");\n  const postsService = {\n    // Create post\n    async createPost(userId, caption, mediaUrl, mediaType) {\n      try {\n        const postData = {\n          user_id: userId,\n          caption\n        };\n        if (mediaUrl) {\n          if (mediaType === 'video') {\n            postData.video_url = mediaUrl;\n          } else {\n            postData.image_url = mediaUrl;\n          }\n        }\n        const {\n          data,\n          error\n        } = await _libSupabase.supabase.from('posts').insert(postData).select().single();\n        if (error) throw error;\n        return {\n          success: true,\n          postId: data.id\n        };\n      } catch (error) {\n        console.error('Create post error:', error);\n        return {\n          success: false,\n          error: error.message\n        };\n      }\n    },\n    // Get posts for user\n    async getUserPosts(userId) {\n      const {\n        data,\n        error\n      } = await _libSupabase.supabase.from('posts').select('*').eq('user_id', userId).order('created_at', {\n        ascending: false\n      });\n      if (error) {\n        console.error('Get user posts error:', error);\n        return [];\n      }\n      return data || [];\n    },\n    // Get feed posts (following)\n    async getFeedPosts(userId) {\n      const {\n        data,\n        error\n      } = await _libSupabase.supabase.from('posts').select(`\n        *,\n        profiles:user_id (username, avatar_url)\n      `).order('created_at', {\n        ascending: false\n      }).limit(50);\n      if (error) {\n        console.error('Get feed posts error:', error);\n        return [];\n      }\n      return data || [];\n    },\n    // Like post\n    async likePost(postId, userId) {\n      try {\n        const {\n          error\n        } = await _libSupabase.supabase.from('post_likes').insert({\n          post_id: postId,\n          user_id: userId\n        });\n        if (error) throw error;\n\n        // Increment likes count\n        await _libSupabase.supabase.rpc('increment_post_likes', {\n          post_id: postId\n        });\n        return true;\n      } catch (error) {\n        console.error('Like post error:', error);\n        return false;\n      }\n    },\n    // Unlike post\n    async unlikePost(postId, userId) {\n      try {\n        await _libSupabase.supabase.from('post_likes').delete().eq('post_id', postId).eq('user_id', userId);\n\n        // Decrement likes count\n        await _libSupabase.supabase.rpc('decrement_post_likes', {\n          post_id: postId\n        });\n        return true;\n      } catch (error) {\n        console.error('Unlike post error:', error);\n        return false;\n      }\n    },\n    // Add comment\n    async addComment(postId, userId, content) {\n      try {\n        const {\n          error\n        } = await _libSupabase.supabase.from('post_comments').insert({\n          post_id: postId,\n          user_id: userId,\n          content\n        });\n        if (error) throw error;\n\n        // Increment comments count\n        await _libSupabase.supabase.rpc('increment_post_comments', {\n          post_id: postId\n        });\n        return true;\n      } catch (error) {\n        console.error('Add comment error:', error);\n        return false;\n      }\n    }\n  };\n});","lineCount":136,"map":[[7,2,22,0,"Object"],[7,8,22,0],[7,9,22,0,"defineProperty"],[7,23,22,0],[7,24,22,0,"exports"],[7,31,22,0],[8,4,22,0,"enumerable"],[8,14,22,0],[9,4,22,0,"get"],[9,7,22,0],[9,18,22,0,"get"],[9,19,22,0],[10,6,22,0],[10,13,22,0,"postsService"],[10,25,22,0],[11,4,22,0],[12,2,22,0],[13,2,1,0],[13,6,1,0,"_libSupabase"],[13,18,1,0],[13,21,1,0,"require"],[13,28,1,0],[13,29,1,0,"_dependencyMap"],[13,43,1,0],[14,2,22,7],[14,8,22,13,"postsService"],[14,20,22,25],[14,23,22,28],[15,4,23,2],[16,4,24,2],[16,10,24,8,"createPost"],[16,20,24,18,"createPost"],[16,21,24,19,"userId"],[16,27,24,33],[16,29,24,35,"caption"],[16,36,24,51],[16,38,24,53,"mediaUrl"],[16,46,24,70],[16,48,24,72,"mediaType"],[16,57,24,101],[16,59,24,167],[17,6,25,4],[17,10,25,8],[18,8,26,6],[18,14,26,12,"postData"],[18,22,26,25],[18,25,26,28],[19,10,27,8,"user_id"],[19,17,27,15],[19,19,27,17,"userId"],[19,25,27,23],[20,10,28,8,"caption"],[21,8,29,6],[21,9,29,7],[22,8,31,6],[22,12,31,10,"mediaUrl"],[22,20,31,18],[22,22,31,20],[23,10,32,8],[23,14,32,12,"mediaType"],[23,23,32,21],[23,28,32,26],[23,35,32,33],[23,37,32,35],[24,12,33,10,"postData"],[24,20,33,18],[24,21,33,19,"video_url"],[24,30,33,28],[24,33,33,31,"mediaUrl"],[24,41,33,39],[25,10,34,8],[25,11,34,9],[25,17,34,15],[26,12,35,10,"postData"],[26,20,35,18],[26,21,35,19,"image_url"],[26,30,35,28],[26,33,35,31,"mediaUrl"],[26,41,35,39],[27,10,36,8],[28,8,37,6],[29,8,39,6],[29,14,39,12],[30,10,39,14,"data"],[30,14,39,18],[31,10,39,20,"error"],[32,8,39,26],[32,9,39,27],[32,12,39,30],[32,18,39,36,"supabase"],[32,30,39,44],[32,31,39,44,"supabase"],[32,39,39,44],[32,40,40,9,"from"],[32,44,40,13],[32,45,40,14],[32,52,40,21],[32,53,40,22],[32,54,41,9,"insert"],[32,60,41,15],[32,61,41,16,"postData"],[32,69,41,24],[32,70,41,25],[32,71,42,9,"select"],[32,77,42,15],[32,78,42,16],[32,79,42,17],[32,80,43,9,"single"],[32,86,43,15],[32,87,43,16],[32,88,43,17],[33,8,45,6],[33,12,45,10,"error"],[33,17,45,15],[33,19,45,17],[33,25,45,23,"error"],[33,30,45,28],[34,8,47,6],[34,15,47,13],[35,10,47,15,"success"],[35,17,47,22],[35,19,47,24],[35,23,47,28],[36,10,47,30,"postId"],[36,16,47,36],[36,18,47,38,"data"],[36,22,47,42],[36,23,47,43,"id"],[37,8,47,46],[37,9,47,47],[38,6,48,4],[38,7,48,5],[38,8,48,6],[38,15,48,13,"error"],[38,20,48,23],[38,22,48,25],[39,8,49,6,"console"],[39,15,49,13],[39,16,49,14,"error"],[39,21,49,19],[39,22,49,20],[39,42,49,40],[39,44,49,42,"error"],[39,49,49,47],[39,50,49,48],[40,8,50,6],[40,15,50,13],[41,10,50,15,"success"],[41,17,50,22],[41,19,50,24],[41,24,50,29],[42,10,50,31,"error"],[42,15,50,36],[42,17,50,38,"error"],[42,22,50,43],[42,23,50,44,"message"],[43,8,50,52],[43,9,50,53],[44,6,51,4],[45,4,52,2],[45,5,52,3],[46,4,54,2],[47,4,55,2],[47,10,55,8,"getUserPosts"],[47,22,55,20,"getUserPosts"],[47,23,55,21,"userId"],[47,29,55,35],[47,31,55,54],[48,6,56,4],[48,12,56,10],[49,8,56,12,"data"],[49,12,56,16],[50,8,56,18,"error"],[51,6,56,24],[51,7,56,25],[51,10,56,28],[51,16,56,34,"supabase"],[51,28,56,42],[51,29,56,42,"supabase"],[51,37,56,42],[51,38,57,7,"from"],[51,42,57,11],[51,43,57,12],[51,50,57,19],[51,51,57,20],[51,52,58,7,"select"],[51,58,58,13],[51,59,58,14],[51,62,58,17],[51,63,58,18],[51,64,59,7,"eq"],[51,66,59,9],[51,67,59,10],[51,76,59,19],[51,78,59,21,"userId"],[51,84,59,27],[51,85,59,28],[51,86,60,7,"order"],[51,91,60,12],[51,92,60,13],[51,104,60,25],[51,106,60,27],[52,8,60,29,"ascending"],[52,17,60,38],[52,19,60,40],[53,6,60,46],[53,7,60,47],[53,8,60,48],[54,6,62,4],[54,10,62,8,"error"],[54,15,62,13],[54,17,62,15],[55,8,63,6,"console"],[55,15,63,13],[55,16,63,14,"error"],[55,21,63,19],[55,22,63,20],[55,45,63,43],[55,47,63,45,"error"],[55,52,63,50],[55,53,63,51],[56,8,64,6],[56,15,64,13],[56,17,64,15],[57,6,65,4],[58,6,66,4],[58,13,66,11,"data"],[58,17,66,15],[58,21,66,19],[58,23,66,21],[59,4,67,2],[59,5,67,3],[60,4,69,2],[61,4,70,2],[61,10,70,8,"getFeedPosts"],[61,22,70,20,"getFeedPosts"],[61,23,70,21,"userId"],[61,29,70,35],[61,31,70,54],[62,6,71,4],[62,12,71,10],[63,8,71,12,"data"],[63,12,71,16],[64,8,71,18,"error"],[65,6,71,24],[65,7,71,25],[65,10,71,28],[65,16,71,34,"supabase"],[65,28,71,42],[65,29,71,42,"supabase"],[65,37,71,42],[65,38,72,7,"from"],[65,42,72,11],[65,43,72,12],[65,50,72,19],[65,51,72,20],[65,52,73,7,"select"],[65,58,73,13],[65,59,73,14],[66,0,74,0],[67,0,75,0],[68,0,76,0],[68,7,76,7],[68,8,76,8],[68,9,77,7,"order"],[68,14,77,12],[68,15,77,13],[68,27,77,25],[68,29,77,27],[69,8,77,29,"ascending"],[69,17,77,38],[69,19,77,40],[70,6,77,46],[70,7,77,47],[70,8,77,48],[70,9,78,7,"limit"],[70,14,78,12],[70,15,78,13],[70,17,78,15],[70,18,78,16],[71,6,80,4],[71,10,80,8,"error"],[71,15,80,13],[71,17,80,15],[72,8,81,6,"console"],[72,15,81,13],[72,16,81,14,"error"],[72,21,81,19],[72,22,81,20],[72,45,81,43],[72,47,81,45,"error"],[72,52,81,50],[72,53,81,51],[73,8,82,6],[73,15,82,13],[73,17,82,15],[74,6,83,4],[75,6,84,4],[75,13,84,11,"data"],[75,17,84,15],[75,21,84,19],[75,23,84,21],[76,4,85,2],[76,5,85,3],[77,4,87,2],[78,4,88,2],[78,10,88,8,"likePost"],[78,18,88,16,"likePost"],[78,19,88,17,"postId"],[78,25,88,31],[78,27,88,33,"userId"],[78,33,88,47],[78,35,88,67],[79,6,89,4],[79,10,89,8],[80,8,90,6],[80,14,90,12],[81,10,90,14,"error"],[82,8,90,20],[82,9,90,21],[82,12,90,24],[82,18,90,30,"supabase"],[82,30,90,38],[82,31,90,38,"supabase"],[82,39,90,38],[82,40,91,9,"from"],[82,44,91,13],[82,45,91,14],[82,57,91,26],[82,58,91,27],[82,59,92,9,"insert"],[82,65,92,15],[82,66,92,16],[83,10,92,18,"post_id"],[83,17,92,25],[83,19,92,27,"postId"],[83,25,92,33],[84,10,92,35,"user_id"],[84,17,92,42],[84,19,92,44,"userId"],[85,8,92,51],[85,9,92,52],[85,10,92,53],[86,8,94,6],[86,12,94,10,"error"],[86,17,94,15],[86,19,94,17],[86,25,94,23,"error"],[86,30,94,28],[88,8,96,6],[89,8,97,6],[89,14,97,12,"supabase"],[89,26,97,20],[89,27,97,20,"supabase"],[89,35,97,20],[89,36,97,21,"rpc"],[89,39,97,24],[89,40,97,25],[89,62,97,47],[89,64,97,49],[90,10,97,51,"post_id"],[90,17,97,58],[90,19,97,60,"postId"],[91,8,97,67],[91,9,97,68],[91,10,97,69],[92,8,99,6],[92,15,99,13],[92,19,99,17],[93,6,100,4],[93,7,100,5],[93,8,100,6],[93,15,100,13,"error"],[93,20,100,18],[93,22,100,20],[94,8,101,6,"console"],[94,15,101,13],[94,16,101,14,"error"],[94,21,101,19],[94,22,101,20],[94,40,101,38],[94,42,101,40,"error"],[94,47,101,45],[94,48,101,46],[95,8,102,6],[95,15,102,13],[95,20,102,18],[96,6,103,4],[97,4,104,2],[97,5,104,3],[98,4,106,2],[99,4,107,2],[99,10,107,8,"unlikePost"],[99,20,107,18,"unlikePost"],[99,21,107,19,"postId"],[99,27,107,33],[99,29,107,35,"userId"],[99,35,107,49],[99,37,107,69],[100,6,108,4],[100,10,108,8],[101,8,109,6],[101,14,109,12,"supabase"],[101,26,109,20],[101,27,109,20,"supabase"],[101,35,109,20],[101,36,110,9,"from"],[101,40,110,13],[101,41,110,14],[101,53,110,26],[101,54,110,27],[101,55,111,9,"delete"],[101,61,111,15],[101,62,111,16],[101,63,111,17],[101,64,112,9,"eq"],[101,66,112,11],[101,67,112,12],[101,76,112,21],[101,78,112,23,"postId"],[101,84,112,29],[101,85,112,30],[101,86,113,9,"eq"],[101,88,113,11],[101,89,113,12],[101,98,113,21],[101,100,113,23,"userId"],[101,106,113,29],[101,107,113,30],[103,8,115,6],[104,8,116,6],[104,14,116,12,"supabase"],[104,26,116,20],[104,27,116,20,"supabase"],[104,35,116,20],[104,36,116,21,"rpc"],[104,39,116,24],[104,40,116,25],[104,62,116,47],[104,64,116,49],[105,10,116,51,"post_id"],[105,17,116,58],[105,19,116,60,"postId"],[106,8,116,67],[106,9,116,68],[106,10,116,69],[107,8,118,6],[107,15,118,13],[107,19,118,17],[108,6,119,4],[108,7,119,5],[108,8,119,6],[108,15,119,13,"error"],[108,20,119,18],[108,22,119,20],[109,8,120,6,"console"],[109,15,120,13],[109,16,120,14,"error"],[109,21,120,19],[109,22,120,20],[109,42,120,40],[109,44,120,42,"error"],[109,49,120,47],[109,50,120,48],[110,8,121,6],[110,15,121,13],[110,20,121,18],[111,6,122,4],[112,4,123,2],[112,5,123,3],[113,4,125,2],[114,4,126,2],[114,10,126,8,"addComment"],[114,20,126,18,"addComment"],[114,21,126,19,"postId"],[114,27,126,33],[114,29,126,35,"userId"],[114,35,126,49],[114,37,126,51,"content"],[114,44,126,66],[114,46,126,86],[115,6,127,4],[115,10,127,8],[116,8,128,6],[116,14,128,12],[117,10,128,14,"error"],[118,8,128,20],[118,9,128,21],[118,12,128,24],[118,18,128,30,"supabase"],[118,30,128,38],[118,31,128,38,"supabase"],[118,39,128,38],[118,40,129,9,"from"],[118,44,129,13],[118,45,129,14],[118,60,129,29],[118,61,129,30],[118,62,130,9,"insert"],[118,68,130,15],[118,69,130,16],[119,10,130,18,"post_id"],[119,17,130,25],[119,19,130,27,"postId"],[119,25,130,33],[120,10,130,35,"user_id"],[120,17,130,42],[120,19,130,44,"userId"],[120,25,130,50],[121,10,130,52,"content"],[122,8,130,60],[122,9,130,61],[122,10,130,62],[123,8,132,6],[123,12,132,10,"error"],[123,17,132,15],[123,19,132,17],[123,25,132,23,"error"],[123,30,132,28],[125,8,134,6],[126,8,135,6],[126,14,135,12,"supabase"],[126,26,135,20],[126,27,135,20,"supabase"],[126,35,135,20],[126,36,135,21,"rpc"],[126,39,135,24],[126,40,135,25],[126,65,135,50],[126,67,135,52],[127,10,135,54,"post_id"],[127,17,135,61],[127,19,135,63,"postId"],[128,8,135,70],[128,9,135,71],[128,10,135,72],[129,8,137,6],[129,15,137,13],[129,19,137,17],[130,6,138,4],[130,7,138,5],[130,8,138,6],[130,15,138,13,"error"],[130,20,138,18],[130,22,138,20],[131,8,139,6,"console"],[131,15,139,13],[131,16,139,14,"error"],[131,21,139,19],[131,22,139,20],[131,42,139,40],[131,44,139,42,"error"],[131,49,139,47],[131,50,139,48],[132,8,140,6],[132,15,140,13],[132,20,140,18],[133,6,141,4],[134,4,142,2],[135,2,143,0],[135,3,143,1],[136,0,143,2],[136,3]],"functionMap":{"names":["<global>","createPost","getUserPosts","getFeedPosts","likePost","unlikePost","addComment"],"mappings":"AAA;ECuB;GD4B;EEG;GFY;EGG;GHe;EIG;GJgB;EKG;GLgB;EMG;GNgB"},"hasCjsExports":false},"type":"js/module"}]}